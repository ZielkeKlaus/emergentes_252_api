# ğŸ¨ DIAGRAMAS VISUAIS - Para ApresentaÃ§Ã£o

## ğŸ“Š ARQUITETURA COMPLETA DO SISTEMA

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DOCKER HOST (Sua MÃ¡quina)                            â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              DOCKER NETWORK: cursos_network (bridge)                    â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚ â”‚
â”‚  â”‚  â”‚   CONTAINER 1    â”‚  â”‚   CONTAINER 2    â”‚  â”‚   CONTAINER 3    â”‚     â”‚ â”‚
â”‚  â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚     â”‚ â”‚
â”‚  â”‚  â”‚  ğŸ—„ï¸ PostgreSQL  â”‚  â”‚  âš™ï¸ Backend API â”‚  â”‚  ğŸ¨ Frontend    â”‚     â”‚ â”‚
â”‚  â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚     â”‚ â”‚
â”‚  â”‚  â”‚  Image:          â”‚  â”‚  Build:          â”‚  â”‚  Build:          â”‚     â”‚ â”‚
â”‚  â”‚  â”‚  postgres:15     â”‚  â”‚  ./cursos_api    â”‚  â”‚  ./cursos_web    â”‚     â”‚ â”‚
â”‚  â”‚  â”‚  -alpine         â”‚  â”‚  Dockerfile      â”‚  â”‚  Dockerfile      â”‚     â”‚ â”‚
â”‚  â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚     â”‚ â”‚
â”‚  â”‚  â”‚  Port: 5432      â”‚â—„â”€â”¤  Port: 3001     â”‚â—„â”€â”¤  Port: 80        â”‚     â”‚ â”‚
â”‚  â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚     â”‚ â”‚
â”‚  â”‚  â”‚  User:           â”‚  â”‚  Tech Stack:     â”‚  â”‚  Tech Stack:     â”‚     â”‚ â”‚
â”‚  â”‚  â”‚  cursosuser      â”‚  â”‚  - Node.js 18    â”‚  â”‚  - React 18      â”‚     â”‚ â”‚
â”‚  â”‚  â”‚                  â”‚  â”‚  - TypeScript    â”‚  â”‚  - Vite          â”‚     â”‚ â”‚
â”‚  â”‚  â”‚  Database:       â”‚  â”‚  - Express       â”‚  â”‚  - Nginx         â”‚     â”‚ â”‚
â”‚  â”‚  â”‚  cursosdb        â”‚  â”‚  - Prisma ORM    â”‚  â”‚  - Tailwind CSS  â”‚     â”‚ â”‚
â”‚  â”‚  â”‚                  â”‚  â”‚  - JWT Auth      â”‚  â”‚                  â”‚     â”‚ â”‚
â”‚  â”‚  â”‚  Health:         â”‚  â”‚                  â”‚  â”‚  Serve:          â”‚     â”‚ â”‚
â”‚  â”‚  â”‚  pg_isready âœ“    â”‚  â”‚  Health:         â”‚  â”‚  Static Files    â”‚     â”‚ â”‚
â”‚  â”‚  â”‚                  â”‚  â”‚  /health/db âœ“    â”‚  â”‚                  â”‚     â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ â”‚
â”‚  â”‚           â”‚                                                             â”‚ â”‚
â”‚  â”‚           â”‚                                                             â”‚ â”‚
â”‚  â”‚      â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚ â”‚
â”‚  â”‚      â”‚   VOLUME    â”‚   PersistÃªncia de Dados                           â”‚ â”‚
â”‚  â”‚      â”‚  postgres   â”‚   (Sobrevive ao docker-compose down)              â”‚ â”‚
â”‚  â”‚      â”‚   _data     â”‚                                                    â”‚ â”‚
â”‚  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  Portas Expostas para Host:                                                 â”‚
â”‚  â”œâ”€ 80 â†’ Frontend (http://localhost)                                        â”‚
â”‚  â”œâ”€ 3001 â†’ Backend API (http://localhost:3001)                              â”‚
â”‚  â””â”€ 5432 â†’ PostgreSQL (localhost:5432)                                      â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ FLUXO DE DADOS - RequisiÃ§Ã£o Completa

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   USUÃRIO    â”‚
â”‚  (Navegador) â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. Acessa http://localhost
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CONTAINER: Frontend (Nginx)            â”‚
â”‚  Porta: 80                              â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  React App (index.html)        â”‚    â”‚
â”‚  â”‚  + JavaScript Bundle           â”‚    â”‚
â”‚  â”‚  + CSS (Tailwind)              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ 2. JavaScript faz requisiÃ§Ã£o
           â”‚    GET /cursos via Axios
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CONTAINER: Backend (Node.js)           â”‚
â”‚  Porta: 3001                            â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Express Router                 â”‚    â”‚
â”‚  â”‚    â†“                            â”‚    â”‚
â”‚  â”‚  Route Handler (/cursos)        â”‚    â”‚
â”‚  â”‚    â†“                            â”‚    â”‚
â”‚  â”‚  Prisma ORM                     â”‚â”€â”€â”€â”€â”¼â”€â”€â”
â”‚  â”‚    â†“                            â”‚    â”‚  â”‚
â”‚  â”‚  Query Builder                  â”‚    â”‚  â”‚ 3. SQL Query
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚    SELECT * FROM cursos
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                                             â”‚
                                             â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  CONTAINER: PostgreSQL              â”‚
                            â”‚  Porta: 5432                        â”‚
                            â”‚                                     â”‚
                            â”‚  DATABASE_URL:                      â”‚
                            â”‚  postgresql://cursosuser:***        â”‚
                            â”‚  @database:5432/cursosdb            â”‚
                            â”‚                                     â”‚
                            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
                            â”‚  â”‚  Tabelas:                 â”‚     â”‚
                            â”‚  â”‚  - categorias             â”‚     â”‚
                            â”‚  â”‚  - usuarios               â”‚     â”‚
                            â”‚  â”‚  - cursos â—„â”€â”€â”€â”€ Query     â”‚     â”‚
                            â”‚  â”‚  - matriculas             â”‚     â”‚
                            â”‚  â”‚  - avaliacoes             â”‚     â”‚
                            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
                            â”‚                                     â”‚
                            â”‚  Volume:                            â”‚
                            â”‚  /var/lib/postgresql/data           â”‚
                            â”‚         â†•                           â”‚
                            â”‚  postgres_data (persistente)        â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ 4. Retorna Dados
                                       â”‚
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  Backend processa resultado         â”‚
                            â”‚  Retorna JSON Response              â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ 5. Response HTTP 200
                                       â”‚    JSON: [{curso1}, {curso2}...]
                                       â”‚
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  Frontend recebe dados              â”‚
                            â”‚  React renderiza componentes        â”‚
                            â”‚  Exibe cursos na tela               â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ 6. Mostra para usuÃ¡rio
                                       â”‚
                                  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
                                  â”‚ UsuÃ¡rio  â”‚
                                  â”‚ Visualizaâ”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸŒ REDE DOCKER - ResoluÃ§Ã£o de Nomes

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          DOCKER INTERNAL DNS                       â”‚
â”‚                                                    â”‚
â”‚  Nome do ServiÃ§o    â†’    IP Interno               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚
â”‚  database           â†’    172.18.0.2               â”‚
â”‚  backend            â†’    172.18.0.3               â”‚
â”‚  frontend           â†’    172.18.0.4               â”‚
â”‚                                                    â”‚
â”‚  (IPs sÃ£o exemplos - Docker atribui dinamicamente)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Como o Backend se Conecta ao Banco:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend Container                   â”‚
â”‚                                      â”‚
â”‚  DATABASE_URL =                      â”‚
â”‚  "postgresql://cursosuser:senha      â”‚
â”‚   @database:5432/cursosdb"           â”‚
â”‚           â–²                          â”‚
â”‚           â”‚                          â”‚
â”‚           â””â”€â”€â”€â”€ Docker resolve       â”‚
â”‚                 "database" para      â”‚
â”‚                 172.18.0.2           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¾ PERSISTÃŠNCIA - Volume Docker

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CICLO DE VIDA DOS DADOS                              â”‚
â”‚                                                       â”‚
â”‚  SITUAÃ‡ÃƒO 1: Container Ativo                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  PostgreSQL  â”‚â—„â”€â”€â”€â”€â–ºâ”‚  Volume Docker  â”‚          â”‚
â”‚  â”‚  Container   â”‚ Read â”‚  postgres_data  â”‚          â”‚
â”‚  â”‚              â”‚ Writeâ”‚                 â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                       â”‚
â”‚  SITUAÃ‡ÃƒO 2: docker-compose down                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  PostgreSQL  â”‚      â”‚  Volume Docker  â”‚          â”‚
â”‚  â”‚  (destruÃ­do) â”‚      â”‚  postgres_data  â”‚          â”‚
â”‚  â”‚      âŒ      â”‚      â”‚  (permanece) âœ“  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                       â”‚
â”‚  SITUAÃ‡ÃƒO 3: docker-compose up novamente             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  PostgreSQL  â”‚â—„â”€â”€â”€â”€â–ºâ”‚  Volume Docker  â”‚          â”‚
â”‚  â”‚  (novo)      â”‚ Usa  â”‚  postgres_data  â”‚          â”‚
â”‚  â”‚              â”‚ dadosâ”‚  (dados antigos)â”‚          â”‚
â”‚  â”‚      âœ“       â”‚ âœ“    â”‚       âœ“         â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                       â”‚
â”‚  Dados Sobrevivem! âœ…                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LocalizaÃ§Ã£o do Volume:
Windows: C:\ProgramData\Docker\volumes\cursos_postgres_data
Linux:   /var/lib/docker/volumes/cursos_postgres_data
Mac:     ~/Library/Containers/com.docker.docker/Data/vms/...
```

---

## ğŸ” VARIÃVEIS DE AMBIENTE - Fluxo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Arquivo .env (raiz do projeto)                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚  DB_USER=cursosuser                                     â”‚
â”‚  DB_PASSWORD=cursospass123                              â”‚
â”‚  DB_NAME=cursosdb                                       â”‚
â”‚  JWT_KEY=minha_chave_secreta                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. docker-compose.yml lÃª variÃ¡veis                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚  services:                                              â”‚
â”‚    database:                                            â”‚
â”‚      environment:                                       â”‚
â”‚        POSTGRES_USER: ${DB_USER}      â—„â”€â”€ SubstituÃ­do  â”‚
â”‚        POSTGRES_PASSWORD: ${DB_PASSWORD} â—„â”€â”€ aqui      â”‚
â”‚                                                         â”‚
â”‚    backend:                                             â”‚
â”‚      environment:                                       â”‚
â”‚        DATABASE_URL: postgresql://${DB_USER}:...        â”‚
â”‚        JWT_KEY: ${JWT_KEY}                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. Containers recebem variÃ¡veis                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                                         â”‚
â”‚  [Container Database]                                   â”‚
â”‚  POSTGRES_USER=cursosuser                               â”‚
â”‚  POSTGRES_PASSWORD=cursospass123                        â”‚
â”‚  POSTGRES_DB=cursosdb                                   â”‚
â”‚                                                         â”‚
â”‚  [Container Backend]                                    â”‚
â”‚  DATABASE_URL=postgresql://cursosuser:***@database:5432 â”‚
â”‚  JWT_KEY=minha_chave_secreta                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. AplicaÃ§Ã£o usa variÃ¡veis                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚  const prisma = new PrismaClient({                      â”‚
â”‚    datasources: {                                       â”‚
â”‚      db: {                                              â”‚
â”‚        url: process.env.DATABASE_URL  â—„â”€â”€ Aqui!        â”‚
â”‚      }                                                  â”‚
â”‚    }                                                    â”‚
â”‚  })                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ï¸ BUILD PROCESS - Multi-stage

```
DOCKERFILE DO BACKEND (2 EstÃ¡gios):

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STAGE 1: Builder                        â”‚
â”‚  Base: node:18-alpine                    â”‚
â”‚                                          â”‚
â”‚  1. COPY package*.json                   â”‚
â”‚  2. RUN npm ci (instala deps)            â”‚
â”‚  3. COPY cÃ³digo fonte                    â”‚
â”‚  4. RUN npx prisma generate              â”‚
â”‚  5. RUN npm run build (compila TS)       â”‚
â”‚                                          â”‚
â”‚  Resultado: /app/dist/ (cÃ³digo compilado)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ Apenas /dist Ã© copiado
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STAGE 2: Production                     â”‚
â”‚  Base: node:18-alpine (nova imagem)      â”‚
â”‚                                          â”‚
â”‚  1. COPY package*.json                   â”‚
â”‚  2. RUN npm ci --only=production         â”‚
â”‚  3. COPY prisma/schema.prisma            â”‚
â”‚  4. RUN npx prisma generate              â”‚
â”‚  5. COPY --from=builder /app/dist ./dist â”‚
â”‚  6. CMD node dist/index.js               â”‚
â”‚                                          â”‚
â”‚  Resultado: Imagem otimizada (~150MB)    â”‚
â”‚  (sem DevDeps, sem TypeScript source)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Vantagens:
âœ… Imagem final menor
âœ… Apenas produÃ§Ã£o incluÃ­da
âœ… Mais seguro (menos superfÃ­cie de ataque)
```

---

## âš¡ HEALTH CHECKS - Funcionamento

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  HEALTH CHECK DO POSTGRESQL                         â”‚
â”‚                                                     â”‚
â”‚  Comando: pg_isready -U cursosuser -d cursosdb      â”‚
â”‚  Intervalo: a cada 10 segundos                      â”‚
â”‚  Timeout: 5 segundos                                â”‚
â”‚  Retries: 5 tentativas                              â”‚
â”‚                                                     â”‚
â”‚  Timeline:                                          â”‚
â”‚  0s  â”€â–º â“ starting                                â”‚
â”‚  10s â”€â–º âœ“ healthy                                  â”‚
â”‚  20s â”€â–º âœ“ healthy                                  â”‚
â”‚  30s â”€â–º âœ“ healthy (backend pode iniciar)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  HEALTH CHECK DO BACKEND                            â”‚
â”‚                                                     â”‚
â”‚  Comando: wget http://localhost:3001/categorias     â”‚
â”‚  Intervalo: a cada 30 segundos                      â”‚
â”‚  Start Period: 40 segundos (tempo para iniciar)     â”‚
â”‚                                                     â”‚
â”‚  Depende de: database (service_healthy)             â”‚
â”‚                                                     â”‚
â”‚  SÃ³ inicia quando:                                  â”‚
â”‚  database.health == "healthy" âœ“                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ COMPARAÃ‡ÃƒO: Com Docker vs Sem Docker

```
SEM DOCKER (Tradicional):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Desenvolvedor A (Windows)                    â”‚
â”‚  - Instalar PostgreSQL 15                     â”‚
â”‚  - Instalar Node.js 18                        â”‚
â”‚  - Configurar PATH                            â”‚
â”‚  - npm install                                â”‚
â”‚  - Configurar .env manualmente                â”‚
â”‚  - Criar banco cursosdb                       â”‚
â”‚  - Rodar migrations                           â”‚
â”‚  - npm run dev                                â”‚
â”‚                                               â”‚
â”‚  Problemas:                                   â”‚
â”‚  âŒ "Funciona na minha mÃ¡quina"              â”‚
â”‚  âŒ VersÃµes diferentes de PostgreSQL         â”‚
â”‚  âŒ Conflitos de porta                       â”‚
â”‚  âŒ ConfiguraÃ§Ã£o manual demorada             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

COM DOCKER:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Qualquer Desenvolvedor (Qualquer OS)         â”‚
â”‚  - git clone projeto                          â”‚
â”‚  - docker-compose up                          â”‚
â”‚                                               â”‚
â”‚  Vantagens:                                   â”‚
â”‚  âœ… Ambiente idÃªntico para todos             â”‚
â”‚  âœ… VersÃµes garantidas via imagem            â”‚
â”‚  âœ… Portas gerenciadas                       â”‚
â”‚  âœ… Setup automÃ¡tico                         â”‚
â”‚  âœ… Isolamento completo                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Use estes diagramas durante a apresentaÃ§Ã£o!** ğŸ¯
